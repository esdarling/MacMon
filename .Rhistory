biplot(wealth.pca)
d$wealth_PCA <- (-1)*predict(wealth.pca)[,2]
hist(d$wealth_PCA)
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
meta <- read.csv("HouseholdSurveys_metadata.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(meta)
nrow(meta)
names(meta)
names(meta)[1] <- "id"
head(d)
d2 <- inner_join(meta,d)
names(d)
d2 <- inner_join(meta,d[,c(1,51)])
View(`d2`)
d2 %>%
group_by(District,Village) %>%
summarize(MSL = mean(wealth_PCA))
levels(as.factor(meat$Village))
levels(as.factor(meta$Village))
#import metadata
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
meta <- read.csv("HouseholdSurveys_metadata.csv", header = TRUE,
stringsAsFactors = FALSE, strip.white = TRUE)
head(meta)
nrow(meta)
names(meta)[1] <- "id"
levels(as.factor(meta$Village))
head(d)
names(d)
d2 <- inner_join(meta,d[,c(1,51)])
d2 %>%
group_by(District,Village) %>%
summarize(MSL = mean(wealth_PCA))
d2 %>%
group_by(District,Village) %>%
summarize(MSL = mean(wealth_PCA)) %>%
arrange(MSL)
d2 %>%
group_by(District,Village) %>%
summarize(MSL = mean(wealth_PCA))
d2 %>%
group_by(District,Village) %>%
summarize(MSL = mean(wealth_PCA)) %>%
arrange(MSL)
d2 %>%
group_by(District,Village) %>%
summarize(MSL = mean(wealth_PCA)) %>%
ungroup() %>%
arrange(MSL)
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/output")
write.csv(MSL, "MSL by village.csv", row.names = FALSE)
MSL <- d2 %>%
group_by(District,Village) %>%
summarize(MSL = mean(wealth_PCA)) %>%
ungroup() %>%
arrange(MSL)
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/output")
write.csv(MSL, "MSL by village.csv", row.names = FALSE)
setwd("/Users/emilydarling/Dropbox/MacMon Fiji/MacMon Latest Data/")
getwd()
xls_files <- dir(pattern='*.xlsx$', recursive = T)
xls_files
excelFile <- paste(getwd(), xls_files[9], sep = "/")
excelFile
nameSheets <- sheetNames(excelFile)
nameSheets
MSL <- read.xls(excelFile, sheet="Material Style of Life")
head(MSL)
head(MSL[-1,])
MSL <_ head(MSL[-1,])
MSL <- MSL[-1,]
head(MSL)
View(MSL)
MSL <- read.xls(excelFile, sheet="Material Style of Life")
names(MSL) <- MSL[1,]
head(MSL)
MSL <- read.xls(excelFile, sheet="Material Style of Life")
head(MSL)
MSL[1,]
?read.xls
MSL <- read.xls(excelFile, sheet="Material Style of Life", col.names = 2)
head(MSL)
MSL <- read.xls(excelFile, sheet="Material Style of Life", names = 2)
head(MSL)
names(MSL) <- MSL[1,]
head(MSL)
head(MSL)
MSL <- read.xls(excelFile, sheet="Material Style of Life", names = 2)
head(MSL)
MSL <- read.xls(excelFile, sheet="Material Style of Life")
head(MSL)
MSL[1,]
names(MSL) <- MSL[1,]
head(MSL)
MSL <- read.xls(excelFile, sheet="Material Style of Life")
head(MSL)
colnames(MSL) <- MSL[1,]
head(MSL)
head(MSL)
MSL[1,]
MSL <- read.xls(excelFile, sheet="Material Style of Life")
colnames(MSL) <- MSL[1,]
MSL <- MSL[-1,]
head(MSL)
MSL[1,]
MSL <- read.xls(excelFile, sheet="Material Style of Life")
head(MSL)
MSL[1,]
colnames(MSL)
?rename
rename(MSL)
head(MSL)
rename(MSL) <- MSL[1,]
library("plyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
setwd("/Users/emilydarling/Dropbox/MacMon Fiji/MacMon Latest Data/")
getwd()
xls_files <- dir(pattern='*.xlsx$', recursive = T)
xls_files
excelFile <- paste(getwd(), xls_files[9], sep = "/")
nameSheets <- sheetNames(excelFile)
nameSheets
MSL <- read.xls(excelFile, sheet="Material Style of Life")
# read most recent survey from MacMon Fiji dropbox folder
setwd("/Users/emilydarling/Dropbox/MacMon Fiji/MacMon Latest Data/")
getwd()
xls_files <- dir(pattern='*.xlsx$', recursive = T)
xls_files
excelFile <- paste(getwd(), xls_files[9], sep = "/")
nameSheets <- sheetNames(excelFile)
nameSheets
MSL <- read.xls(excelFile, sheet="Material Style of Life")
head(MSL)
View(MSL)
paste(MSL[1,])
as.charater(MSL[1,])
as.character(MSL[1,])
head(MSL)
# read most recent survey from MacMon Fiji dropbox folder
d <- read.csv("HouseholdSurveys_MSL question.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
names(d)
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
d <- read.csv("HouseholdSurveys_MSL question.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
names(d)
#remove other & non
d <- d[,-c(16,17,24,25,31,36,40,47,53,59)]
names(d)
indicators <- d[,c(3:44)]
#check indicators will all zeros - need to remove
#car battery, bicyclce, motorcycle, charcoal, tile, bamboo
names(indicators)
wealth.pca<-prcomp(indicators, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,5:13,20:25,27,30,32,34:36,39:42)]
names(indicators2)
indicators2 <- indicators[,c(1:2,5:13,20:25,27:42)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:13,20,21,23,24:27,30:33]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,5:8,10:13,16,20,21,23,24:27,30:33]
names(indicators2)
indicators2 <- indicators[,c(1:2,5:8,10:13,16,20,21,23,24:27,30:33)]
names(indicators2)
names(indicators)
indicators2 <- indicators[,c(1:2,5:8,10:13,16,20:25)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:8,10:13,16,20:25)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:8,10:13,16,20:25)]
names(indicators2)
names(indicators)
indicators2 <- indicators[,c(1:2,5:8,10:13,16,20,22:25)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
levels(as.factor(d$Village))
indicators <- d[,c(3:44)]
#check indicators will all zeros - need to remove
#car battery, bicyclce, motorcycle, charcoal, tile, bamboo
names(indicators)
indicators2 <- indicators[,c(1:2,5:8,10:13,16,20,22:25)]
names(indicators2)
indicators2 <- indicators[,c(1:2,5:8,10:13)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:8)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,5:7)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:8)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,5:7,10:13)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:7,10:12)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:7,10)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:7)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
d <- read.csv("HouseholdSurveys_MSL question.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
names(d)
nrow(d)
#remove other & non
d <- d[,-c(16,17,24,25,31,36,40,47,53,59)]
names(d)
levels(as.factor(d$Village))
indicators <- d[,c(3:44)]
#check indicators will all zeros - need to remove
#car battery, bicyclce, motorcycle, charcoal, tile, bamboo
names(indicators)
indicators2 <- indicators[,c(1:2,5:7)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,5:7,8)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators$Radio
indicators <- na.omit(indicators)
nrow(indicator)
nrow(indicators)
indicators2 <- indicators[,c(1:2,5:7)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,5:7,10:12)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
indicators2 <- indicators[,c(1:2,5:7,10:12,16,20,22:25)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
names(indicators)
indicators2 <- indicators[,c(1:2,5:7,10:12,16,20,22:25,27:30,32,34,35,36,39:42)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
summary(wealth.pca)
wealth.pca
biplot(wealth.pca)
summary(wealth.pca)
wealth.pca
wealth.pca
d$wealth_PCA <- predict(wealth.pca)[,1]
hist(d$wealth_PCA)
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
d <- read.csv("HouseholdSurveys_MSL question.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
#remove other & non
d <- d[,-c(16,17,24,25,31,36,40,47,53,59)]
d <- na.omit(d)
nrow(d)
levels(as.factor(d$Village))
indicators <- d[,c(3:44)]
#check indicators will all zeros - need to remove
#car battery, bicyclce, motorcycle, charcoal, tile, bamboo
names(indicators)
nrow(indicators)
indicators2 <- indicators[,c(1:2,5:7,10:12,16,20,22:25,27:30,32,34,35,36,39:42)]
names(indicators2)
wealth.pca<-prcomp(indicators2, scale = TRUE, na.action = na.omit)
summary(wealth.pca)
wealth.pca
biplot(wealth.pca)
d$wealth_PCA <- predict(wealth.pca)[,1]
hist(d$wealth_PCA)
head(d)
boxplot(d$wealth_PCA ~ d$Village)
MSL <- d %>%
group_by(Village) %>%
summarize(MSL = mean(wealth_PCA)) %>%
ungroup() %>%
arrange(MSL)
MSL
write.csv(MSL, "MSL by village.csv", row.names = FALSE)
MSL
MSL <- d %>%
group_by(Village) %>%
summarize(MSL = mean(wealth_PCA), sd = sd(wealth_PCA)) %>%
ungroup() %>%
arrange(MSL)
MSL
round(MSL$MSL,2)
MSL$value <- paster(round(MSL$MSL,2), round(MSL$sd,2), sep = (" ("))
MSL$value <- paste(round(MSL$MSL,2), round(MSL$sd,2), sep = (" ("))
MSL$value
MSL$value <- paste(MSL$value, ")")
MSL$value
MSL$value <- paste(round(MSL$MSL,2), round(MSL$sd,2), sep = (" ("))
MSL$value <- paste(MSL$value, ")", sep = "")
MSL$value
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/output")
write.csv(MSL, "MSL by village.csv", row.names = FALSE)
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
env <- read.csv("fromMaina_stressmodel.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(env)
nrow(env)
##MAINA CLIMATE - pulled from coral database
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
env <- read.csv("fromMaina_stressmodel.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(env)
nrow(env)
env %>%
group_by(Location) %>%
summarize(mean_exp <- mean(multivariate.stress.model), sd_exp = sd(multivariate.stress.model))
env %>%
group_by(Location) %>%
summarize(mean_exp = mean(multivariate.stress.model), sd_exp = sd(multivariate.stress.model))
env <- env %>%
group_by(Location) %>%
summarize(mean_exp = mean(multivariate.stress.model), sd_exp = sd(multivariate.stress.model))
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/output")
write.csv(env, "Maina stressmodel by Location.csv", row.names= FALSE)
env$value <- paste(round(env$env,2), round(env$sd,2), sep = (" ("))
env$value <- paste(env$value, ")", sep = "")
env$value
env <- env %>%
group_by(Location) %>%
summarize(mean_exp = mean(multivariate.stress.model), sd_exp = sd(multivariate.stress.model))
env
##MAINA CLIMATE - pulled from coral database
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
env <- read.csv("fromMaina_stressmodel.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(env)
nrow(env)
env <- env %>%
group_by(Location) %>%
summarize(mean_exp = mean(multivariate.stress.model), sd_exp = sd(multivariate.stress.model))
env
##MAINA CLIMATE - pulled from coral database
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
env <- read.csv("fromMaina_stressmodel.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(env)
nrow(env)
env <- env %>%
group_by(Location) %>%
summarize(mean_exp = mean(multivariate.stress.model), sd_exp = sd(multivariate.stress.model))
env
env$value <- paste(round(env$mean_exp,2), round(env$sd_exp,2), sep = (" ("))
env$value <- paste(env$value, ")", sep = "")
env$value
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/output")
write.csv(env, "Maina stressmodel by Location.csv", row.names= FALSE)
##Household dependance on livelihoods
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
d <- read.csv("Household finances.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
levels(as.factor(d$Type))
names(d)[6] <- "propIncome"
d %>%
filter(Type == Income) %>%
group_by(Village,id,Type) %>%
summarize(propIncome = mean(propIncome))
d %>%
filter(Type == "Income") %>%
group_by(Village,id,Type) %>%
summarize(propIncome = mean(propIncome))
##Household dependance on livelihoods
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
d <- read.csv("Household finances.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
names(d)[1] <- "id"
names(d)[6] <- "propIncome"
levels(as.factor(d$Type))
d %>%
filter(Type == "Income") %>%
group_by(Village,id,Type) %>%
summarize(propIncome = mean(propIncome))
d %>%
filter(Type == "Income") %>%
group_by(Village,id,Type) %>%
summarize(propIncome = mean(propIncome, na.rm = TRUE))
d %>%
filter(Type == "Income") %>%
group_by(Village,id,Source) %>%
summarize(propIncome = mean(propIncome, na.rm = TRUE))
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
d <- read.csv("Household finances.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
names(d)[1] <- "id"
names(d)[6] <- "propIncome"
levels(as.factor(d$Type))
View(d)
levels(as.factor(d$Source))
d %>%
filter(Type == "Income") %>%
group_by(Village,id,Source) %>%
summarize(propIncome = mean(propIncome, na.rm = TRUE))
d2_cast <- dcast(d2, Village + id ~ Source)
d2 <- d %>%
filter(Type == "Income") %>%
group_by(Village,id,Source) %>%
summarize(propIncome = mean(propIncome, na.rm = TRUE))
d2_cast <- dcast(d2, Village + id ~ Source)
View(`d2_cast`)
levels(as.factor(d$Source))
d$Source <- CA(d$Source)
levels(as.factor(d$Source))
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/data")
d <- read.csv("Household finances.csv", header = TRUE, stringsAsFactors = FALSE, strip.white = TRUE)
head(d)
nrow(d)
names(d)[1] <- "id"
names(d)[6] <- "propIncome"
levels(as.factor(d$Type))
d$Source <- CA(d$Source)
levels(as.factor(d$Source))
d$Source2 <- ifelse((d$Source == "Bdm collection (fishing)" | d$Source == "Bdm-middlemen" |
d$Source == "Fishing" | d$Source == "Pafco - Tuna Cannery" | d$Source == "Selling Frozen Fish"),
"Fishing",
ielse(d$Source == "Animal Husbandry" | d$Source == "Copra" | d$Source == "Farming" |
d$Source == "Selling Food/crops"), "Farming", "Other")
d$Source2 <- ifelse(d$Source == "Bdm collection (fishing)" | d$Source == "Bdm-middlemen" |
d$Source == "Fishing" | d$Source == "Pafco - Tuna Cannery" | d$Source == "Selling Frozen Fish",
"Fishing", ielse(d$Source == "Animal Husbandry" | d$Source == "Copra" | d$Source == "Farming" |
d$Source == "Selling Food/crops", "Farming", "Other"))
d$Source2 <- ifelse(d$Source == "Bdm collection (fishing)" | d$Source == "Bdm-middlemen" |
d$Source == "Fishing" | d$Source == "Pafco - Tuna Cannery" | d$Source == "Selling Frozen Fish",
"Fishing", ifelse(d$Source == "Animal Husbandry" | d$Source == "Copra" | d$Source == "Farming" |
d$Source == "Selling Food/crops", "Farming", "Other"))
d$Source2
head(d)
d2 <- d %>%
filter(Type == "Income") %>%
group_by(Village,id,Source2) %>%
summarize(propIncome = mean(propIncome, na.rm = TRUE))
View(`d2`)
d2_cast <- dcast(d2, Village + id ~ Source2)
View(`d2_cast`)
d2_cast[is.na(d2_cast)] <- 0
head(d2_cast)
d3 <- melt(d2_cast[,1:4], id.var = 1:2])
d3 <- melt(d2_cast[,1:4], id.var = 1:2)
head(d3)
d3 %>%
group_by(Village, variable) %>%
mean_income = mean(value)
d3 %>%
group_by(Village, variable) %>%
summarize(mean_income = mean(value))
d3 %>%
group_by(Village, variable) %>%
summarize(mean_income = mean(value)) %>%
arrange(variable, Village)
d3 %>%
group_by(Village, variable) %>%
summarize(mean_income = mean(value)) %>%
ungroup() %>%
arrange(variable, Village)
d4 <- d3 %>%
group_by(Village, variable) %>%
summarize(mean_income = mean(value))
d4_cast <- dcast(d4, Village ~ variable)
d4_cast
d4_cast <- dcast(d4, variable ~ Village)
d4_cast
setwd("/Users/emilydarling/Dropbox/4_WCS MacMon/1_MacMon data/R_Emily/Fiji/output")
write.csv(d4_cast, "Income dependence.csv")
levels(as.factor(d4$Village))
d4$Village <- factor(d4$Village, levels = c("Kiobo","Navatu","Bua-Lomanikoro","Dalomo","Arovudi","Taviya",
"Nabukadra","Nadogoloa"))
levels(as.factor(d4$Village))
d4_cast <- dcast(d4, variable ~ Village)
d4_cast
levels(as.factor(d4$Village))
d4 <- d3 %>%
group_by(Village, variable) %>%
summarize(mean_income = mean(value))
levels(as.factor(d4$Village))
d4 <- subset(d4, Village == "Kiobo" | Village =="Navatu" | Village == "Bua-Lomanikoro" |
Village == "Dalomo" | Village == "Arovudi" | Village == "Taviya" |
Village == "Nabukadra" | Village == "Nadogoloa")
d4$Village <- factor(d4$Village, levels = c("Kiobo","Navatu","Bua-Lomanikoro","Dalomo","Arovudi","Taviya",
"Nabukadra","Nadogoloa"))
levels(drop.levels(as.factor(d4$Village)))
d4_cast <- dcast(d4, variable ~ Village)
d4_cast
d4$variable <- factor(d4$variable, levels = c("Fishing","Farming")
d4_cast <- dcast(d4, variable ~ Village)
d4_cast
d4$variable <- factor(d4$variable, levels = c("Fishing","Farming"))
d4_cast <- dcast(d4, variable ~ Village)
d4_cast
